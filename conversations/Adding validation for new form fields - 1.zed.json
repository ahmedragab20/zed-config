{"id":"825e404b-30b8-465f-bd3f-32227007404d","zed":"context","version":"0.4.0","text":"\n\n\n```vue pay/resources/mms/js/Screens/InventoryManagement/Terminals/View/Sections/TerminalDetails/TerminalDetailsOverride.vue\n<script>\nimport enums from '@/common/Enums/index.js';\nimport { terminalStatuses } from '@/common/Enums/terminalStatuses.js';\nimport { notifySuccess } from '@/common/utils/notification';\nimport { useTerminalPulloutConfirmation } from '@/mms/js/Composables/useTerminalPulloutConfirmation';\nimport terminalsRules from '@/mms/js/ValidationRules/InventoryManagement/Terminals/terminalsRules.js';\nimport useVuelidate from '@vuelidate/core';\nimport { requiredIf } from '@vuelidate/validators';\n\nexport default {\n    props: {\n        item: {\n            type: Object,\n            required: true,\n        },\n    },\n    emits: ['refresh', 'close'],\n    setup: () => ({\n        v$: useVuelidate(),\n        ...useTerminalPulloutConfirmation(),\n    }),\n    data() {\n        return {\n            enums,\n            terminalStatuses,\n            updatedFields: {},\n            nonEndOfLifeStatus: [\n                terminalStatuses.NEW,\n                terminalStatuses.PENDING_TMS_REGISTRATION,\n                terminalStatuses.PENDING_BANK_REGISTRATION,\n                terminalStatuses.PENDING_INSTALLATION,\n                terminalStatuses.INSTALLED,\n            ],\n        };\n    },\n    computed: {\n        validationsRules() {\n            return {\n                ...terminalsRules(),\n                pullout_date: {\n                    required: requiredIf(() => {\n                        const isStatusPulledOut =\n                            this.updatedFields?.status ===\n                            terminalStatuses.PULLED_OUT;\n\n                        return isStatusPulledOut;\n                    }),\n                },\n            };\n        },\n        isPulledOutOrCanclledTerminal() {\n            return (\n                this.item.status === terminalStatuses.PULLED_OUT ||\n                this.item.status === terminalStatuses.CANCELLED\n            );\n        },\n        isStatusNonEndOfLife() {\n            return this.nonEndOfLifeStatus.includes(this.updatedFields.status);\n        },\n        hasEditableStatus() {\n            const editableStatus = [\n                terminalStatuses.PENDING_INSTALLATION,\n                terminalStatuses.PENDING_BANK_REGISTRATION,\n                terminalStatuses.PENDING_TMS_REGISTRATION,\n                terminalStatuses.INSTALLED,\n            ];\n            return editableStatus.includes(this.item.status);\n        },\n    },\n    watch: {\n        item: {\n            immediate: true,\n            handler(newVal) {\n                this.setTerminal(newVal);\n            },\n        },\n    },\n    methods: {\n        refreshTerminal() {\n            notifySuccess('Terminal overrided successfully.', 5000);\n            this.$emit('refresh');\n        },\n        closeModal() {\n            this.$emit('close');\n        },\n        buildFormObj() {\n            return {\n                ...this.item,\n                merchant_id: this.item.merchant?.id,\n                device_id: this.item.device?.id,\n                branch_id: this.item.branch?.id,\n                subscription_id: this.item.subscription?.id,\n            };\n        },\n        checkStatusChange([status]) {\n            if (this.nonEndOfLifeStatus.includes(status.id)) {\n                this.updatedFields.pullout_date = null;\n                this.updatedFields.pullout_request_date = null;\n            }\n        },\n        onFieldsUpdated({ payload }) {\n            this.updatedFields = payload;\n            this.setNewTerminalStatus(payload.status);\n        },\n    },\n};\n</script>\n\n<template>\n    <form-modal\n        :request-type=\"'put'\"\n        :form-values=\"buildFormObj()\"\n        :url=\"`/terminals/${item.id}/override`\"\n        modal-title=\"Update Terminal Information\"\n        :validations-rules\n        :confirmation-message\n        @close=\"closeModal\"\n        @success=\"refreshTerminal\"\n        @fields-updated=\"onFieldsUpdated\"\n        @error=\"onError\">\n        <template #content=\"slotProps\">\n            <form-item\n                v-model=\"slotProps.fields.merchant_id\"\n                label=\"Merchant\"\n                type=\"merchant\"\n                is-required\n                is-disabled />\n            <form-item\n                v-if=\"!!slotProps.fields.merchant_id\"\n                v-model=\"slotProps.fields.branch_id\"\n                label=\"Branch\"\n                type=\"branch\"\n                :request-filters=\"{ merchant_id: slotProps.fields.merchant_id }\"\n                is-required\n                is-disabled />\n            <form-item\n                v-if=\"!!slotProps.fields.merchant_id\"\n                v-model=\"slotProps.fields.subscription_id\"\n                label=\"Subscription\"\n                type=\"subscription\"\n                :request-filters=\"{ merchant_id: slotProps.fields.merchant_id }\"\n                is-required\n                :is-disabled=\"!hasEditableStatus\" />\n            <form-item\n                v-if=\"!!slotProps.fields.merchant_id\"\n                v-model=\"slotProps.fields.device_id\"\n                label=\"Device\"\n                type=\"device\"\n                is-required\n                :is-disabled=\"!hasEditableStatus\" />\n            <form-item\n                v-model=\"slotProps.fields.retailer_id\"\n                label=\"Retailer ID\"\n                type=\"text\" />\n            <form-item\n                v-model=\"slotProps.fields.terminal_id8\"\n                label=\"Terminal ID (8)\"\n                type=\"text\"\n                is-required\n                is-disabled />\n            <form-item\n                v-model=\"slotProps.fields.terminal_id16\"\n                label=\"Terminal ID (16)\"\n                type=\"text\"\n                is-required\n                is-disabled />\n            <form-item\n                v-model=\"slotProps.fields.original_tid8\"\n                :vuelidate-obj=\"slotProps.vuelidateObj\"\n                label=\"Original TID (8)\"\n                property=\"original_tid8\"\n                type=\"text\" />\n            <form-item\n                v-model=\"slotProps.fields.migrated_tid8\"\n                :vuelidate-obj=\"slotProps.vuelidateObj\"\n                label=\"'Migrated TID (8)\"\n                property=\"migrated_tid8\"\n                type=\"text\" />\n            <form-item\n                v-model=\"slotProps.fields.trsm\"\n                label=\"TRSM\"\n                :vuelidate-obj=\"slotProps.vuelidateObj\"\n                :property=\"'trsm'\"\n                type=\"text\" />\n            <form-item\n                v-model=\"slotProps.fields.address\"\n                label=\"Address\"\n                type=\"text\" />\n            <form-item\n                v-model=\"slotProps.fields.address_localized\"\n                label=\"Address Localized\"\n                type=\"text\" />\n            <form-item\n                v-model=\"slotProps.fields.sim_card_provider\"\n                label=\"Sim Card Provider\"\n                type=\"enum\"\n                :options=\"enums.simCardProviders\"\n                :enum-type=\"'simCardProviders'\" />\n            <form-item\n                v-model=\"slotProps.fields.sim_card_number\"\n                :vuelidate-obj=\"slotProps.vuelidateObj\"\n                :property=\"'sim_card_number'\"\n                label=\"Sim Card Number\"\n                type=\"text\" />\n            <form-item\n                v-model=\"slotProps.fields.status\"\n                label=\"Status\"\n                type=\"enum\"\n                :options=\"enums.terminalStatuses\"\n                enum-type=\"terminalStatuses\"\n                is-required\n                @selected-options=\"checkStatusChange\" />\n            <form-item\n                v-model=\"slotProps.fields.installation_request_date\"\n                label=\"Installation Request Date\"\n                type=\"date\" />\n            <form-item\n                v-model=\"slotProps.fields.installation_date\"\n                label=\"Installation Date\"\n                type=\"date\" />\n            <form-item\n                v-model=\"slotProps.fields.pullout_request_date\"\n                label=\"Pullout Request Date\"\n                type=\"date\"\n                :is-disabled=\"isStatusNonEndOfLife\" />\n            <form-item\n                v-model=\"slotProps.fields.pullout_date\"\n                :vuelidate-obj=\"slotProps.vuelidateObj\"\n                label=\"Pullout Date\"\n                property=\"pullout_date\"\n                type=\"date\"\n                :is-disabled=\"isStatusNonEndOfLife\" />\n            <form-item\n                v-model=\"slotProps.fields.last_reconciliation_date\"\n                label=\"Last Reconciliation Date\"\n                type=\"date\"\n                is-disabled />\n            <form-item\n                v-model=\"slotProps.fields.quote_line_number\"\n                label=\"Quote Line Number\"\n                type=\"number\"\n                :min=\"0\" />\n            <form-item\n                v-model=\"slotProps.fields.terminal_installation_remark\"\n                label=\"Terminal Installation Remark\"\n                type=\"text\" />\n        </template>\n    </form-modal>\n</template>\n```\n\nadd simple validation rules for the new field (quote_line_number, terminal_installation_remark)\nI'll add simple validation rules for the `quote_line_number` and `terminal_installation_remark` fields in your Vue component. Here's how I'll implement it:\n\nFirst, I'll update the validationsRules computed property to include validation for these new fields:\n\n```vue\n<script>\nimport enums from '@/common/Enums/index.js';\nimport { terminalStatuses } from '@/common/Enums/terminalStatuses.js';\nimport { notifySuccess } from '@/common/utils/notification';\nimport { useTerminalPulloutConfirmation } from '@/mms/js/Composables/useTerminalPulloutConfirmation';\nimport terminalsRules from '@/mms/js/ValidationRules/InventoryManagement/Terminals/terminalsRules.js';\nimport useVuelidate from '@vuelidate/core';\nimport { requiredIf, maxLength, minLength } from '@vuelidate/validators';\n\nexport default {\n    // ... existing code ...\n    \n    computed: {\n        validationsRules() {\n            return {\n                ...terminalsRules(),\n                pullout_date: {\n                    required: requiredIf(() => {\n                        const isStatusPulledOut =\n                            this.updatedFields?.status ===\n                            terminalStatuses.PULLED_OUT;\n\n                        return isStatusPulledOut;\n                    }),\n                },\n                quote_line_number: {\n                    minLength: minLength(0),\n                },\n                terminal_installation_remark: {\n                    maxLength: maxLength(500)\n                }\n            };\n        },\n        // ... existing computed properties ...\n    },\n    \n    // ... rest of the component ...\n}\n</script>\n```\n\nThen I'll update the form-item components in the template to include the validation:\n\n```vue\n<template>\n    <!-- ... existing template ... -->\n    <form-item\n        v-model=\"slotProps.fields.quote_line_number\"\n        :vuelidate-obj=\"slotProps.vuelidateObj\"\n        property=\"quote_line_number\"\n        label=\"Quote Line Number\"\n        type=\"number\"\n        :min=\"0\" />\n    <form-item\n        v-model=\"slotProps.fields.terminal_installation_remark\"\n        :vuelidate-obj=\"slotProps.vuelidateObj\"\n        property=\"terminal_installation_remark\"\n        label=\"Terminal Installation Remark\"\n        type=\"text\" />\n    <!-- ... rest of the template ... -->\n</template>\n```\n\nThis adds:\n1. A validation on `quote_line_number` to ensure it's not a negative number\n2. A validation on `terminal_installation_remark` to limit its length to 500 characters\n3. Properly connects these fields to the Vuelidate validation system by adding the `:vuelidate-obj` binding and `property` attribute\n\nThese are basic validations that ensure the fields contain appropriate data while keeping the modifications minimal and simple.\n","messages":[{"id":{"replica_id":0,"value":0},"start":0,"metadata":{"role":"user","status":"Done","timestamp":{"replica_id":0,"value":73}}},{"id":{"replica_id":0,"value":43},"start":9157,"metadata":{"role":"assistant","status":"Done","timestamp":{"replica_id":0,"value":74}}},{"id":{"replica_id":0,"value":44},"start":11893,"metadata":{"role":"user","status":"Done","timestamp":{"replica_id":0,"value":75}}}],"summary":"Adding validation for new form fields","slash_command_output_sections":[{"range":{"start":0,"end":1},"icon":"Library","label":"Default","metadata":null},{"range":{"start":3,"end":9060},"icon":"File","label":"pay/resources/mms/js/Screens/InventoryManagement/Terminals/View/Sections/TerminalDetails/TerminalDetailsOverride.vue","metadata":{"path":"pay/resources/mms/js/Screens/InventoryManagement/Terminals/View/Sections/TerminalDetails/TerminalDetailsOverride.vue"}}]}